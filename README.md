# Major-minor-infant-study
This repository contains the matlab program (randpermTestP1SpikeHeight.m) to run the random permutation test described in "Sensitivity to Major Versus Minor Musical Modes is Bimodally Distributed in Young Infants".  The study was designed to investigate whether infants are bimodally distributed in their sensitivity to major vs. minor musical modes.  The data to be analyzed are responses drawn from a set of N_infs (N_infs = 30 in the "predictable" condition tested in Experiment 1, or N_infs = 20 in the unpredictable condition tested in Experiment 2).  

Different infants i produce different numbers N(i) of responses (called "anticipations" in the article), and a given response is either correct or incorrect. Across all N_infs infants, let N_cor be the total number of correct responses and N_inc be the total number of incorrect responses, and let N_total = N_cor + N_inc. (N_cor = 176, N_inc = 76, and N_total = 205 in the predictable condition; N_cor = 73, N_inc = 69, and N_total = 142 in the unpredictable condition.) For each infant i, let P(i) be the proportion of the N(i) responses produced by infant i that were correct. (High (low) proportions of correct responses reflect high (low) sensitivity to major vs. minor modes.)

Does the obtained data support the conclusion that our infants actually comprise a heterogeneous mixture of high- and low-performers? To investigate this question, we used a random permutation test of the null hypothesis that all of our participants actually have the same probability of responding correctly. Our alternative hypothesis is that the distribution P is bimodal (because it is actually generated by a mixture of high- vs. low-performers). The test statistic SumNGivenPerfect is the sum of N(i) over all infants i for which P(i) = 1;  i.e., the sum total of the responses made by all of those infants who never made an error.

We proceed as follows. On each of nIters iterations (nIters = 1,000,000 in the tests reported in the paper), we generate a simulated distribution sim_P that should be identically distributed to P under the null hypothesis and compute SumNGivenPerfect from sim_P. In each iteration, we first form a random sequence S comprising N_cor ones (for the correct responses) and N_inc zeros; then, for k = 1, 2,..., N_infs, we assign to each successive infant i the next N(i) values in S to determine a simulated number of correct and incorrect responses for infant i and compute the proportion P_sim(i) of correct responses for infant i; then we take the sum of N(i) over all infants i for which P_sim(i) is equal to 1.  We take as our p-value the proportion of such simulations that yield values of SumNGivenPerfect greater than or equal to 33. 

